<!-- TODO -->
<!-- k so user gives username, script opens .txt file named username -->
<!-- file lists YT links, with two values beside em: ups, downs -->
<!-- display this info -->
<!-- display this info http://www.w3schools.com/php/php_file.asp -->
<html>
		<head>
				<link rel="stylesheet" type="text/css" href="style.css">
				<script type="text/javascript" src="swfobject.js"></script>
				<script type="text/javascript">
					swfobject.embedSWF("http://www.youtube.com/v/-XTToohju4s ", "myContent", "300", "120", "9.0.0");
				</script>
				<!-- Angular -->
				<script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.7.5/angular.min.js"></script>
				<!-- Angular view routing -->
				<script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.7.5/angular-route.min.js"></script>
				<title>Vote on Vids</title>
		</head>
		<body ng-app = "AJSapp">		<!--Specify that ajs app contained within body -->
				<center><img src="/res/banner.jpg" width="204" height="100" /></center>
				<center><h1>Menu</h1></center>
				<center>
						<a class="menustyle" href="index.htm">Home</a> --
						<a class="menustyle" href="commlists.php">Community Lists</a> --
						<a class="menustyle" href="ylists.php">Your Lists</a> -- 
						<a class="menustyle" href="contact.php">Contact</a> --
						<a class="menustyle" href="howto.php">How to Use</a>
				</center>
				<!-- use exCtrl for this div -->
				<div ng-controller = "exCtrl">		
				</div>
				<p>		<!-- Links to switch view -->
						<a class = "menustyle" href = "#!viewMessageBoard">View Mesage Board</a> , 
						<a class = "menustyle" href = "#!hideMessageBoard">Hide Message Board</a>
				</p>
				<div class = "bodyBox" ng-view></div>		<!-- Where router will place view -->
				<!-- Define some ng-templates, id as the .htm files -->
				<script type = "text/ng-template" id = "viewMessageBoard.htm">
						<center>
								<h1>Message Board</h1>
						</center>
						<form> 
								<p>Enter your name and a message, press submit to add to message board.</p>
								<div>
										<label>Name:</label>
										<input type="text" ng-model="newName">
										<label>Message:</label>
										<input type="text" ng-model="newData">
										<input type="button" value="Add" ng-click="addDataToMsgBoard()">
								</div>
						</form>
						<table>	
								<tr>
										<th>Time Stamp</th>
										<th>Name</th>
										<th>Data</th>
								</tr>
						</table>
						<div id="autoScrollBox">
								<table>
										<tr ng-repeat="data in msgData">
												<td>{{data.TimeStamp}}</td>
												<td>{{data.Name}}</td>
												<td>{{data.Data}}</td>
										</tr>
								</table>	
						</div>
				</script>
				<script type = "text/ng-template" id = "hideMessageBoard.htm">
						Click link to show the message board. 
				</script>

				<script>							
						// create AJSapp module
						var AJSapp = angular.module("AJSapp", ['ngRoute']);		// Load with dependency ngRoute
						// $routeProvider is a services which sets config of URLs, maps em to corresponding .htm page of ng-template
						// attaches a controller as well 
						AJSapp.config(['$routeProvider', function($routeProvider) 
						{
								$routeProvider.when
								('/viewMessageBoard', 
										{
												templateUrl: 'viewMessageBoard.htm', 
												controller: 'msgBoardController'
										}
								);
								$routeProvider.when
								('/hideMessageBoard', 
										{
												templateUrl: 'hideMessageBoard.htm', 
												controller: 'hideMsgBoardController'
										}
								);
								$routeProvider.otherwise		// Default when no other matches
								(
										{
										 		redirectTo: '/hideMessageBoard'
										}
								);
						}]);

						// Use $http service to make AJAX call to get data from text file
						AJSapp.controller("msgBoardController", function($scope,$http) 
								{
										$scope.msgData;
										//	This func retreives JSON msgs from msgBoard file
										//	url used to be msgBoard.txt but seems that would get cached response
										//	instead of retreive the file with updated response
										//	so serverside php file reads msgBoard file and returns it to calling JS
										$scope.getMsgBoardData = function()
										{
												// Http.get sends Http retreive request, asynchronous response to each callback
		//										/test/demo_form.php?name1=value1&name2=value2
												$http(
												{
														cache: false,		// required so that new fetch is done instead of cached
														method: 'GET',
														url: 'readMsgBoard.php'	 
												}
												).then(
														function successGetMsgCallBack(response) 
														{
																$scope.msgData = response.data;
														}, function failGetMsgCallBack(response)
														{
																$scope.msgData = "getMsgBoardData: Failed to load data";
														}
												);
										};
										$scope.getMsgBoardData();	// Call to get data

										$scope.addDataToMsgBoard = function() 
										{
												var tStamp = new Date();
												$scope.curTStamp = tStamp.toLocaleString();
												$http(
												{
														cache: false,		// required so that new fetch is done instead of cached
														method: 'POST',
														url:  'addToMsgBoard.php',
														data: 
														{
																newName: $scope.newName, 
																newData: $scope.newData, 
																newTStamp: $scope.curTStamp 
														}
												}
												).then(
														function successMsgPostAdd(response) 
														{// on success
																$scope.getMsgBoardData();	// Call to get data
														}, function failMsgPostAdd(response) 
														{
																$scope.msgData = "addDataToMsgBoard: failed to add data";
														}
												);
										};

										$scope.message = "yeyerr"; 
										$scope.obj = 
										{
												name: "namename",
												num: 5,
												val: function()
												{
														var data = $scope.obj;
														return data.name + ", 5 + num = " + (5 + data.num);
												}
										};
								}
						);		// end controller func 

						AJSapp.controller("hideMsgBoardController", function($scope) 
								{
								}
						);		// end controller func 
						// register controller func exCtrl in AJSapp module 
						// scope passed to controller func, create hellto obj, add title field 
						AJSapp.controller("exCtrl", function($scope) 
								{
										$scope.helloTo = {};
										$scope.helloTo.title = "geg";
										$scope.obj = 
										{
												name: "namename",
												num: 5,
												val: function()
												{
														var data = $scope.obj;
														return data.name + ", 5 + num = " + (5 + data.num);
												}
										};
								}
						);		// end controller func 
				</script>
		</body>
</html>

